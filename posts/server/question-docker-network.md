---
title: 도커 네트워크에 대한 질문을 받았다
pubDate: 2024-09-27
tags: [docker, container]
category: 서버
---

# 컨테이너에서 컨테이너로 접근하기

도커 관련해서 처음에 친구가 컨테이너에서 컨테이너로 접근할 수 있는 방법을 모르겠다고 했다.

| Who  | Message                                                                                                                                                                                                                                                        |
| ---- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 친구 | Spring 컨테이너에서 Redis 컨테이너 접속하려고 하는데 localhost:6379로 요청을 보낼 수가 없어                                                                                                                                                                    |
| 나   | 두 컨테이너는 독립적이기 때문에, 서로 다른 로컬 호스트를 가지고 있어서 접근할 수 없어. 서로 다른 컨테이너에 요청을 보내기 위해서는 해당 컨테이너의 IP 주소를 사용해야 해<br><br>`docker network inspect bridge`를 통해서 Redis 컨테이너의 IP 주소를 확인해 봐. |

# 네트워크에서 컨테이너가 사라짐

두번째로 물어본 내용은 위와 같은 방식으로 주소를 적어줬지만 작동하기는 하나, 재배포를 하면 네트워크에서 서버가 사라진다고 했다. 그러면서 첨부한 사진을 보자 저번과 다르게 기본 네트워크인 bridge를 사용하지 않고 새로운 네트워크(test-network)를 만들어서 사용하고 있었다. 나는 그것을 보면서 한가지 문제를 예상해볼 수 있었다.

> 기본 네트워크인 bridge를 사용하지 않으면 재배포하는 과정에서 컨테이너가 삭제되고, 다시 등록되는 과정에서 test-network 네트워크와 연결되지 않는구나! (이때는 --network 옵션을 몰랐음)

그래서 나는 `test-network`에 포함된 컨테이너의 주소를 사용하지 말고 모든 컨테이너가 기본적으로 포함되는 bridge 네트워크의 주소를 사용해보라고 했다.

# 다른 방법도 있지 않을까?

기본 네트워크인 bridge를 사용하라고는 했지만 분명 다른 방법이 있을 것이라고 생각했고, 조금 더 찾아보자 `docker run` 명령어의 옵션으로 `--network`을 사용해서 시작할 때 컨테이너에 네트워크를 결합시킬 수 있는 방법을 찾았다.

```
docker run --network test-network --name example-container example:latest
```

또한 `docker network connect`를 사용해서 필요할 때 네트워크에 컨테이너를 결합할 수도 있다.
